<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Game of Distraction ‚Äî Replica</title>
<style>
  /* Layout inspired by FlowingData post's game */
  :root{
    --bg: #fbfbfb;
    --panel: #ffffff;
    --muted: #666;
    --accent: #ff6b35;
    --accent-2: #ffb48a;
    --glass: rgba(0,0,0,0.04);
  }
  *{box-sizing:border-box}
  html,body{height:100%; margin:0; font-family: "Segoe UI", Roboto, system-ui, -apple-system;}
  body{
    background: linear-gradient(#ffffff,#f3f6f8);
    display:flex; align-items:center; justify-content:center; padding:28px;
    color:#222;
  }

  .container{
    width:980px; max-width:96vw; background:var(--panel); border-radius:10px;
    box-shadow: 0 18px 45px rgba(25,40,60,0.08); padding:22px; display:grid;
    grid-template-columns: 420px 1fr; gap:18px;
  }

  .left {
    background: linear-gradient(180deg,#fff,#fbfbfb);
    border-radius:8px; padding:18px; display:flex; flex-direction:column; gap:12px;
    align-items:center; justify-content:flex-start;
  }

  .title { font-size:18px; font-weight:700; color:#111; margin-bottom:4px; }
  .desc { font-size:13px; color:var(--muted); max-width:360px; text-align:center; }

  .pot-area {
    width:360px; height:330px; border-radius:10px; background:linear-gradient(180deg,#f7f9fb,#eef3f7);
    display:flex; align-items:center; justify-content:center; position:relative; margin-top:6px;
    border:1px solid var(--glass);
  }

  /* big pot look */
  .pot-svg { width:240px; height:200px; cursor:default; user-select:none; }
  .steam { position:absolute; top:18px; left:50%; transform:translateX(-50%); pointer-events:none; opacity:0; transition:opacity 0.25s; }
  .steam span{ display:block; font-size:28px; line-height:18px; opacity:0.9; filter: blur(0.2px); animation:steam 2s linear infinite; }
  .steam span:nth-child(2){ animation-delay:0.45s; font-size:20px; transform:translateY(6px) }
  @keyframes steam { 0% { transform:translateY(0) scale(.7); opacity:0 } 50% { opacity:0.55 } 100% { transform:translateY(-70px) scale(1); opacity:0 } }

  .progress-wrap { position:absolute; left:14px; top:14px; font-size:13px; color:var(--muted); }
  .progress-bar { width:320px; height:12px; background:#fff; border-radius:999px; border:1px solid rgba(0,0,0,0.04); overflow:hidden; margin-top:6px; box-shadow: inset 0 1px 0 rgba(255,255,255,0.6);}
  .progress-fill { height:100%; width:0%; background:linear-gradient(90deg,var(--accent),var(--accent-2)); transition:width 90ms linear; }

  .status-row { display:flex; gap:8px; margin-top:10px; align-items:center; color:var(--muted); font-size:13px; }

  /* right column */
  .right { padding:18px; display:flex; flex-direction:column; gap:12px; }
  .controls { display:flex; gap:10px; align-items:center; }
  button { padding:10px 14px; border-radius:8px; border:0; cursor:pointer; font-weight:700; background:var(--accent); color:white; box-shadow: 0 6px 18px rgba(255,107,53,0.12); }
  button.ghost { background:transparent; color:var(--muted); border:1px solid rgba(0,0,0,0.06) }
  .instructions { font-size:13px; color:var(--muted); line-height:1.45; }

  .field { position:relative; background:linear-gradient(#fff,#fbfbfd); border-radius:10px; min-height:240px; border:1px dashed rgba(0,0,0,0.04); overflow:hidden; }
  .distraction { position:absolute; transform:translate(-50%,-50%); font-size:28px; cursor:pointer; user-select:none; transition:transform 0.06s linear; }

  .footer-note { font-size:13px; color:var(--muted); margin-top:6px; }

  .overlay-win { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; background: rgba(255,255,255,0.9); z-index:60; border-radius:10px; }
  .badge { padding:16px 22px; background:linear-gradient(90deg,#ffdcbf,#fff0e6); border-radius:14px; font-weight:800; color:#33150c; box-shadow: 0 10px 30px rgba(220,120,60,0.08); }

  @media (max-width:900px){
    .container { grid-template-columns: 1fr; }
    .left{ order:2 } .right{ order:1 }
  }
</style>
</head>
<body>
  <div class="container" role="application" aria-label="Game of Distraction replica">
    <div class="left">
      <div class="title">Game of Distraction</div>
      <div class="desc">They say a watched pot never boils. Make the pot boil by not watching it ‚Äî look away, click distractions, and rack up points.</div>

      <div class="pot-area" id="potArea" title="Don't hover over the pot ‚Äî move mouse away to make it boil">
        <div class="progress-wrap" aria-hidden="true">
          Boil: <strong id="pct">0%</strong>
          <div class="progress-bar" aria-hidden="true">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div style="margin-top:6px;font-size:12px;color:var(--muted)">Points: <span id="pts">0</span> ¬∑ Boost: <span id="boostTxt">1.00x</span></div>
        </div>

        <!-- Pot SVG -->
        <svg class="pot-svg" viewBox="0 0 220 170" aria-hidden="true">
          <defs>
            <linearGradient id="pg1" x1="0" x2="0" y1="0" y2="1">
              <stop offset="0%" stop-color="#2b2f37"/><stop offset="100%" stop-color="#121518"/>
            </linearGradient>
            <linearGradient id="pg2" x1="0" x2="1" y1="0" y2="0">
              <stop offset="0%" stop-color="#9aa2a9"/><stop offset="100%" stop-color="#6b7277"/>
            </linearGradient>
          </defs>
          <!-- handles -->
          <rect x="6" y="56" width="18" height="6" rx="3" fill="#333" />
          <rect x="196" y="56" width="18" height="6" rx="3" fill="#333" />
          <!-- pot body -->
          <ellipse cx="110" cy="98" rx="86" ry="30" fill="url(#pg1)"/>
          <rect x="24" y="78" width="172" height="46" rx="22" fill="url(#pg1)"/>
          <ellipse cx="110" cy="76" rx="86" ry="20" fill="#0b1116" />
          <!-- lid -->
          <ellipse cx="110" cy="58" rx="96" ry="14" fill="url(#pg2)" opacity="0.98"/>
          <rect x="58" y="46" width="104" height="12" rx="6" fill="url(#pg2)" />
          <circle cx="110" cy="42" r="6" fill="#222" />
          <!-- bubbles (animated via JS insertion) -->
          <g id="bubbles"></g>
        </svg>

        <div class="steam" id="steam" aria-hidden="true" style="display:none">
          <span>‚òÅ</span><span>‚òÅ</span><span>‚òÅ</span>
        </div>

      </div>

      <div class="status-row" aria-hidden="true">
        <div style="font-size:13px;color:var(--muted)">Watching: <strong id="watching" style="margin-left:8px;color:#d04a4a">NO</strong></div>
        <div style="margin-left:auto;font-size:13px;color:var(--muted)">Time: <strong id="timePlayed">0s</strong></div>
      </div>
    </div>

    <div class="right">
      <div class="controls">
        <button id="startBtn">Start</button>
        <button id="resetBtn" class="ghost">Reset</button>
        <div style="margin-left:10px;color:var(--muted);font-size:13px">Difficulty:
          <select id="difficulty" style="margin-left:6px;">
            <option value="1">Easy</option>
            <option value="1.5" selected>Normal</option>
            <option value="2">Hard</option>
          </select>
        </div>
      </div>

      <div class="instructions">
        <strong>How to play</strong>
        <ul>
          <li>Start the game. The pot boils faster when your cursor is away from the pot (or the tab is hidden).</li>
          <li>If you hover above the pot (watching), progress slows or reverses.</li>
          <li>Click floating distractions to gain points and temporary speed boost.</li>
          <li>Reach 100% to win.</li>
        </ul>
      </div>

      <div class="field" id="field" aria-live="polite" aria-label="Distraction field">
        <!-- distractions will be added here -->
      </div>

      <div style="display:flex;justify-content:space-between;align-items:center;margin-top:8px;">
        <div style="font-size:13px;color:var(--muted)">Clicks: <strong id="clicks">0</strong></div>
        <div style="font-size:13px;color:var(--muted)">Boost time left: <strong id="boostLeft">0s</strong></div>
      </div>

      <div class="footer-note">Replica built to mimic the FlowingData "Game of Distraction".</div>
    </div>
  </div>

<script>
/* Replica logic:
 - progress (0..100). Increases when NOT hovering over pot. Decreases while hovering.
 - Clicking a distraction gives points and temporary boost (multiplier).
 - Tab hidden counts as "not watching" (helps boil).
 - Respawns distractions, moves them, they expire.
 - Win overlay on reaching 100%.
*/

(function(){
  // DOM
  const startBtn = document.getElementById('startBtn');
  const resetBtn = document.getElementById('resetBtn');
  const potArea = document.getElementById('potArea');
  const progressFill = document.getElementById('progressFill');
  const pct = document.getElementById('pct');
  const pts = document.getElementById('pts');
  const boostTxt = document.getElementById('boostTxt');
  const field = document.getElementById('field');
  const steam = document.getElementById('steam');
  const watchingEl = document.getElementById('watching');
  const timePlayed = document.getElementById('timePlayed');
  const clicksEl = document.getElementById('clicks');
  const boostLeft = document.getElementById('boostLeft');
  const difficulty = document.getElementById('difficulty');

  let running=false, progress=0, points=0, watching=false, boost=1.0, boostTime=0;
  let clickCount=0, last=performance.now(), raf=null, spawnInterval=null, startAt=null;

  const emojis = ['üç©','üì±','üéÆ','üçï','‚òïÔ∏è','üì∫','üê∂','üç™','üéß','üé®','üß©','üìö'];

  function getDiff(){ return parseFloat(difficulty.value) || 1; }

  function reset(){
    running=false; progress=0; points=0; watching=false; boost=1; boostTime=0; clickCount=0;
    cancelAnim(); clearField();
    updateUI();
    startBtn.disabled=false; startBtn.textContent='Start';
    steam.style.display='none';
    startAt=null;
  }

  function start(){
    if(running) return;
    running=true; progress=0; points=0; clickCount=0; boost=1; boostTime=0;
    startBtn.disabled=true; startBtn.textContent='Running...';
    last = performance.now(); startAt = last;
    spawnInterval = setInterval(()=>maybeSpawn(), 900 / (2-getDiff()), 900);
    raf = requestAnimationFrame(tick);
  }

  function cancelAnim(){ if(raf) cancelAnimationFrame(raf); raf=null; if(spawnInterval) clearInterval(spawnInterval); spawnInterval=null; }

  function clearField(){ field.querySelectorAll('.distraction').forEach(n=>n.remove()); }

  function win(){
    running=false;
    cancelAnim();
    steam.style.display='block';
    startBtn.disabled=false; startBtn.textContent='Start';
    const overlay = document.createElement('div'); overlay.className='overlay-win';
    overlay.innerHTML = '<div class="badge">You boiled it! ' + points + ' pts</div>';
    potArea.appendChild(overlay);
    setTimeout(()=>overlay.remove(), 2400);
  }

  function updateUI(){
    progressFill.style.width = progress.toFixed(2) + '%';
    pct.textContent = Math.floor(progress) + '%';
    pts.textContent = points;
    boostTxt.textContent = boost.toFixed(2) + 'x';
    watchingEl.textContent = watching ? 'YES' : 'NO';
    watchingEl.style.color = watching ? '#d04a4a' : '#2b8f6a';
    clicksEl.textContent = clickCount;
    boostLeft.textContent = Math.max(0, Math.round(boostTime)) + 's';
  }

  function tick(now){
    if(!running) return;
    const dt = (now - last)/1000; last = now;
    const diff = getDiff();

    // time played
    timePlayed.textContent = Math.floor((now - (startAt||now))/1000) + 's';

    // boost decay
    if(boostTime>0){ boostTime = Math.max(0, boostTime - dt); }
    else { boost = Math.max(1, boost - 0.5 * dt); }
    // keep displayed
    boostTxt.textContent = boost.toFixed(2) + 'x';

    // progress changes
    const incBase = 7.5 / diff;
    const decBase = 11 / diff;
    if(!watching){
      progress += incBase * boost * dt;
    } else {
      progress -= decBase * dt;
      progress -= (Math.random()*0.6) * dt;
    }
    if(document.hidden){
      // hidden aids progress
      progress += 1.3 * boost * dt;
    }
    progress = Math.max(0, Math.min(100, progress));
    updateUI();

    if(progress >= 100){ win(); return; }

    // move distractions
    field.querySelectorAll('.distraction').forEach(el=>{
      let x = parseFloat(el.dataset.x || el.style.left.replace('px','') || 0);
      let y = parseFloat(el.dataset.y || el.style.top.replace('px','') || 0);
      let vx = parseFloat(el.dataset.vx||0);
      let vy = parseFloat(el.dataset.vy||0);
      x += vx * 40 * dt; y += vy * 40 * dt;
      const pad = 16;
      if(x < pad){ x = pad; el.dataset.vx = -vx; }
      if(y < pad){ y = pad; el.dataset.vy = -vy; }
      if(x > field.clientWidth - pad){ x = field.clientWidth - pad; el.dataset.vx = -vx; }
      if(y > field.clientHeight - pad){ y = field.clientHeight - pad; el.dataset.vy = -vy; }
      el.style.left = x + 'px'; el.style.top = y + 'px';
      el.dataset.x = x; el.dataset.y = y;
      // life
      el.dataset.life = Math.max(0, parseFloat(el.dataset.life) - dt);
      if(parseFloat(el.dataset.life) <= 0) el.remove();
    });

    // occasional spawn bonus
    if(Math.random() < 0.02 && field.querySelectorAll('.distraction').length < 8) spawn();

    raf = requestAnimationFrame(tick);
  }

  function maybeSpawn(){ if(Math.random() < 0.9) spawn(); }

  function spawn(){
    if(!running) return;
    const e = document.createElement('div');
    e.className = 'distraction';
    e.textContent = emojis[Math.floor(Math.random()*emojis.length)];
    const w = field.clientWidth, h = field.clientHeight;
    const x = Math.random()*(w-40) + 20;
    const y = Math.random()*(h-40) + 20;
    e.style.left = x + 'px'; e.style.top = y + 'px';
    e.dataset.x = x; e.dataset.y = y;
    e.dataset.vx = (Math.random()*2-1) * (0.2 + Math.random()*1.1);
    e.dataset.vy = (Math.random()*2-1) * (0.2 + Math.random()*1.1);
    e.dataset.life = 6 + Math.random()*8;
    e.tabIndex = 0;
    field.appendChild(e);
    e.addEventListener('pointerdown', (ev)=>{ ev.preventDefault(); collect(e); });
    e.addEventListener('keydown', (ev)=>{ if(ev.key === 'Enter' || ev.key === ' ') { ev.preventDefault(); collect(e); } });
  }

  function collect(el){
    // award points and boost
    const base = 12;
    const gained = Math.round(base * (1.2 + Math.random()*1.6) / getDiff());
    points += gained;
    clickCount += 1;
    clicksEl.textContent = clickCount;
    pts.textContent = points;
    // boost
    boost = Math.min(4, boost + 0.45 + Math.random()*0.7);
    boostTime += 3 + Math.random()*4;
    boostLeft.textContent = Math.round(boostTime) + 's';
    // small remove animation
    el.animate([{transform:'scale(1)'},{transform:'scale(1.5)', opacity:0}], {duration:220, easing:'ease-out'});
    el.remove();
    // spawn tiny bubbles in pot for feedback
    spawnBubbles();
  }

  function spawnBubbles(){
    const g = document.getElementById('bubbles');
    // create 6 small circles that float and fade
    for(let i=0;i<6;i++){
      const c = document.createElementNS('http://www.w3.org/2000/svg','circle');
      const cx = 110 + (Math.random()*60-30), cy = 76 + (Math.random()*8-6);
      c.setAttribute('cx', cx); c.setAttribute('cy', cy); c.setAttribute('r', 2 + Math.random()*3);
      c.setAttribute('fill', '#ffd7b0'); c.style.opacity=0.95;
      g.appendChild(c);
      // animate via JS
      const dur = 700 + Math.random()*600;
      const start = performance.now();
      (function animateBubble(node, t0, dur){
        function frame(t){
          const p = (t - t0)/dur;
          if(p >= 1){ node.remove(); return; }
          node.setAttribute('cy', cy - p*40 - Math.random()*8);
          node.style.opacity = String(1 - p);
          requestAnimationFrame(frame);
        }
        requestAnimationFrame(frame);
      })(c, start, dur);
    }
  }

  // watch detection via pointerenter/leave on potArea
  potArea.addEventListener('pointerenter', ()=>{ if(running){ watching = true; updateUI(); } });
  potArea.addEventListener('pointerleave', ()=>{ if(running){ watching = false; updateUI(); } });

  // clicking the pot penalizes (small)
  potArea.addEventListener('pointerdown', (ev)=>{
    if(!running) return;
    watching = true; updateUI();
    progress = Math.max(0, progress - 2.5);
    points = Math.max(0, points - 3);
    updateUI();
    setTimeout(()=>{ watching = false; updateUI(); }, 700);
  });

  // tab visibility ‚Äî hidden helps boil
  document.addEventListener('visibilitychange', ()=>{ if(!running) return; if(document.hidden) watching = false; updateUI(); });

  // keyboard spawn (space)
  document.addEventListener('keydown', (ev)=>{
    if(ev.code === 'Space' && running){
      ev.preventDefault();
      spawn();
    }
  });

  // ui handlers
  startBtn.addEventListener('click', start);
  resetBtn.addEventListener('click', reset);

  // small periodic updates
  setInterval(()=>{
    if(!running) return;
    // reduce boost smoothly if no boostTime
    if(boostTime <= 0 && boost > 1) boost = Math.max(1, boost - 0.3);
    if(boostTime > 0) boost = Math.max(boost, 1.0);
    if(boostTime > 0) boostTime = Math.max(0, boostTime - 0.5);
    updateUI();
  }, 500);

  // start in reset state
  reset();

  // mobile: tapping on empty field spawns new distraction sometimes
  field.addEventListener('pointerdown', (ev)=>{
    if(!running) return;
    if(ev.target === field && Math.random() < 0.35) spawn();
  });

})();
</script>
</body>
</html>
